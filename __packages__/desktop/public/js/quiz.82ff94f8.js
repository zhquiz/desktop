(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["quiz"],{2218:function(e,t,n){},"2e44":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",[e.isInit?n("div",{staticClass:"QuizPage"},[n("div",{staticClass:"columns",staticStyle:{"flex-wrap":"wrap"}},[n("div",{staticClass:"column is-4-fullhd is-5"},[n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("Type")]),n("b-field",{staticClass:"flex-wrap"},[n("b-checkbox-button",{attrs:{"native-value":"hanzi",type:"is-success"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[e._v(" Hanzi ")]),n("b-checkbox-button",{attrs:{"native-value":"vocab",type:"is-success"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[e._v(" Vocab ")]),n("b-checkbox-button",{attrs:{"native-value":"sentence",type:"is-success"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[e._v(" Sentence ")])],1)],1)]),n("div",{staticClass:"column is-4-fullhd is-7"},[n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("Learning stage")]),n("b-field",{staticClass:"flex-wrap"},[n("b-checkbox-button",{attrs:{"native-value":"new",type:"is-success"},model:{value:e.stage,callback:function(t){e.stage=t},expression:"stage"}},[e._v(" New ")]),n("b-checkbox-button",{attrs:{"native-value":"leech",type:"is-success"},model:{value:e.stage,callback:function(t){e.stage=t},expression:"stage"}},[e._v(" Leech ")]),n("b-checkbox-button",{attrs:{"native-value":"learning",type:"is-success"},model:{value:e.stage,callback:function(t){e.stage=t},expression:"stage"}},[e._v(" Learning ")]),n("b-checkbox-button",{attrs:{"native-value":"graduated",type:"is-success"},model:{value:e.stage,callback:function(t){e.stage=t},expression:"stage"}},[e._v(" Graduated ")])],1)],1)]),n("div",{staticClass:"column is-4-fullhd is-5",staticStyle:{"min-width":"350px"}},[n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("Extras")]),n("div",{staticClass:"control"},[n("b-switch",{model:{value:e.includeExtra,callback:function(t){e.includeExtra=t},expression:"includeExtra"}},[e._v("User items")]),n("b-switch",{model:{value:e.includeUndue,callback:function(t){e.includeUndue=t},expression:"includeUndue"}},[e._v("Include undue")])],1)])]),n("div",{staticClass:"column",staticStyle:{"min-width":"600px"}},[n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[e._v("Direction")]),n("b-field",{staticClass:"flex-wrap"},[n("b-checkbox-button",{attrs:{"native-value":"se",type:"is-success"},model:{value:e.direction,callback:function(t){e.direction=t},expression:"direction"}},[e._v(" Simplified-English ")]),n("b-checkbox-button",{attrs:{"native-value":"te",type:"is-success"},model:{value:e.direction,callback:function(t){e.direction=t},expression:"direction"}},[e._v(" Traditional-English ")]),n("b-checkbox-button",{attrs:{"native-value":"ec",type:"is-success"},model:{value:e.direction,callback:function(t){e.direction=t},expression:"direction"}},[e._v(" English-Chinese ")])],1)],1)]),n("div",{staticClass:"column",staticStyle:{"min-width":"600px"}},[n("form",{on:{submit:function(t){return t.preventDefault(),e.reload(t)}}},[n("b-field",{attrs:{label:"Filter"}},[n("b-input",{attrs:{placeholder:"Try level:>10,<=20 or tag:HSK4",type:"search"},model:{value:e.q,callback:function(t){e.q=t},expression:"q"}})],1)],1)])]),n("b-collapse",{staticClass:"card",attrs:{animation:"slide",open:e.isQuizDashboardReady},scopedSlots:e._u([{key:"trigger",fn:function(t){return n("div",{staticClass:"card-header",attrs:{role:"button"}},[n("p",{staticClass:"card-header-title"},[e._v("Quiz")]),n("a",{staticClass:"card-header-icon",attrs:{role:"button"}},[n("fontawesome",{attrs:{icon:t.open?"caret-down":"caret-up"}})],1)])}}],null,!1,1178747161)},[n("div",{staticClass:"card-content"},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-3"},[e.includeUndue?n("div",[n("span",{staticClass:"column-label"},[e._v("Pending: ")]),n("span",[e._v(e._s(e._f("format")(e.quizArray.length)))])]):e.dueItems.length?n("div",[n("span",{staticClass:"column-label"},[e._v("Due: ")]),n("span",[e._v(e._s(e._f("format")(e.dueItems.length)))])]):e.dueIn?n("div",[n("span",{staticClass:"column-label"},[e._v("Due in: ")]),n("span",[e._v(e._s(e._f("duration")(e.dueIn)))])]):n("div",[n("span",[e._v("No items due")])])]),n("div",{staticClass:"column is-3"},[n("span",{staticClass:"column-label"},[e._v("New: ")]),n("span",[e._v(e._s(e._f("format")(e.newItems.length)))])]),n("div",{staticClass:"column is-3"},[n("span",{staticClass:"column-label"},[e._v("Leech: ")]),n("span",[e._v(e._s(e._f("format")(e.leechItems.length)))])]),n("div",{staticClass:"column is-3 flex flex-row"},[n("div",{staticClass:"flex-grow"}),n("b-button",{attrs:{type:"is-success",disabled:0===e.quizArray.length},on:{click:e.startQuiz}},[e._v(" Start Quiz ")])],1)])])]),n("QuizCard",{ref:"quizCard",attrs:{"quiz-array":e.quizArray},on:{"quiz:ended":e.reload}}),n("b-collapse",{staticClass:"card",attrs:{animation:"slide",open:e.leechCard.isOpen},on:{"update:open":function(t){return e.$set(e.leechCard,"isOpen",t)}},scopedSlots:e._u([{key:"trigger",fn:function(t){return n("div",{staticClass:"card-header",attrs:{role:"button"}},[n("p",{staticClass:"card-header-title"},[e._v("Leech list ("+e._s(e.leechCard.total)+")")]),n("a",{staticClass:"card-header-icon",attrs:{role:"button"}},[n("fontawesome",{attrs:{icon:t.open?"caret-down":"caret-up"}})],1)])}}],null,!1,1801465784)},[n("div",{staticClass:"card-content"},[n("form",{on:{submit:function(t){return t.preventDefault(),e.onLeechCardSubmit(t)}}},[n("b-field",{attrs:{label:"Search"}},[n("b-input",{model:{value:e.leechCard.q,callback:function(t){e.$set(e.leechCard,"q",t)},expression:"leechCard.q"}})],1)],1),n("b-table",{attrs:{data:e.leechCard.data,paginated:"","backend-pagination":"",total:e.leechCard.total,"current-page":e.leechCard.page,"per-page":e.leechCard.perPage,"backend-sorting":"","default-sort":[e.leechCard.sort.field,e.leechCard.sort.order]},on:{"update:currentPage":function(t){return e.$set(e.leechCard,"page",t)},"update:current-page":function(t){return e.$set(e.leechCard,"page",t)},sort:e.onLeechSort,contextmenu:e.onLeechContextmenu}},[n("b-table-column",{attrs:{field:"entry",label:"Entry",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticClass:"hover-blue cursor-pointer"},[e._v(" "+e._s(t.row.entry)+" ")])]}}],null,!1,755825245)}),n("b-table-column",{attrs:{field:"type",label:"Type",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.type)+" ")]}}],null,!1,1218402693)}),n("b-table-column",{attrs:{field:"direction",label:"Direction",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.direction)+" ")]}}],null,!1,4105406328)}),n("b-table-column",{attrs:{field:"wrongStreak",label:"Wrong Streak",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.wrongStreak)+" ")]}}],null,!1,2978466980)}),n("b-table-column",{attrs:{field:"lastRight",label:"Last Right",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("formatDate")(t.row.lastRight))+" ")]}}],null,!1,3975961)})],1)],1)]),n("b-loading",{attrs:{active:e.isLoading}}),n("ContextMenu",{ref:"context",attrs:{type:e.leechCard.current.type,entry:e.leechCard.current.entry,source:e.leechCard.current.source,direction:e.leechCard.current.direction}})],1):e._e()])},i=[],a=(n("99af"),n("4de4"),n("d81d"),n("2909")),s=n("3835"),c=(n("96cf"),n("1da1")),u=n("d4ec"),o=n("bee2"),l=n("262e"),d=n("2caf"),h=n("9ab4"),p=n("1b40"),v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{staticClass:"quiz-modal",attrs:{active:e.isQuizModal},on:{"update:active":function(t){e.isQuizModal=t},close:e.endQuiz}},[n("div",{staticClass:"card"},[e.current.id?n("div",{staticClass:"card-content"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!e.isQuizShownAnswer,expression:"!isQuizShownAnswer"}],staticClass:"content"},[e.current.source?n("div",["ec"===e.current.direction?n("div",[n("h4",[e._v("Extra English-Chinese")]),n("div",{domProps:{innerHTML:e._s(e.doMask(e.current.english,e.current.entry))}})]):n("div",[n("h4",[e._v("Extra Chinese-English")]),n("div",{staticClass:"font-zh-simp text-w-normal",staticStyle:{"font-size":"2rem"}},[e._v(" "+e._s(e.current.entry)+" ")])])]):"hanzi"===e.current.type?n("div",["ec"===e.current.direction?n("div",[n("h4",[e._v("Hanzi English-Chinese")]),n("div",{domProps:{innerHTML:e._s(e.doMask(e.current.english,e.current.entry))}})]):n("div",[n("h4",[e._v("Hanzi Chinese-English")]),n("div",{staticClass:"font-chinese text-w-normal",staticStyle:{"font-size":"3rem"}},[e._v(" "+e._s(e.current.entry)+" ")])])]):"vocab"===e.current.type?n("div",["te"===e.current.direction?n("div",[n("h4",[e._v("Vocab Traditional-English")]),n("div",{staticClass:"font-zh-trad text-w-normal",staticStyle:{"font-size":"1.7rem"}},e._l(e.current.traditional||[],(function(t,r){return n("span",{key:r,staticClass:"traditional"},[e._v(" "+e._s(t)+" ")])})),0)]):"ec"===e.current.direction?n("div",[n("h4",[e._v("Vocab English-Chinese")]),Array.isArray(e.current.english)?n("ul",e._l(e.current.english,(function(t,r){return n("li",{key:r,domProps:{innerHTML:e._s(e.doMask.apply(void 0,[t,e.current.entry].concat(e.current.pinyin||[],e.current.traditional||[])))}})})),0):n("div",{domProps:{innerHTML:e._s(e.doMask.apply(void 0,[e.current.english,e.current.entry].concat(e.current.pinyin||[],e.current.traditional||[])))}})]):n("div",[n("h4",[e._v("Vocab Simplified-English")]),n("div",{staticClass:"font-zh-simp text-w-normal",staticStyle:{"font-size":"2rem"}},[e._v(" "+e._s(e.current.entry)+" ")])])]):n("div",["ec"===e.current.direction?n("div",[n("h4",[e._v("Sentence English-Chinese")]),e._v(" "+e._s(e.current.english)+" ")]):n("div",[n("h4",[e._v("Sentence Chinese-English")]),n("h2",{staticClass:"font-zh-simp text-w-normal"},[e._v(" "+e._s(e.current.entry)+" ")])])])]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isQuizShownAnswer,expression:"isQuizShownAnswer"}],staticClass:"content"},[e.current.source?n("div",[n("div",{staticClass:"font-zh-simp text-w-normal has-context",staticStyle:{"font-size":"2rem"},on:{contextmenu:function(t){return t.preventDefault(),e.openContext(t)}}},[e._v(" "+e._s(e.current.entry)+" ")]),n("div",[e._v(" "+e._s(e.current.pinyin)+" ")]),n("p",[e._v(" "+e._s(e.current.english)+" ")]),e.sentences.length?n("ul",e._l(e.sentences,(function(t,r){return n("li",{key:r},[n("span",{staticClass:"has-context",attrs:{title:t.pinyin},on:{contextmenu:function(n){return n.preventDefault(),function(n){return e.openContext(n,t.chinese,"sentence")}(n)}}},[e._v(" "+e._s(t.chinese)+" ")]),n("ul",[n("li",{staticClass:"english"},[e._v(" "+e._s(t.english)+" ")])])])})),0):e._e()]):"hanzi"===e.current.type?n("div",[n("div",{staticClass:"hanzi-display has-context",on:{contextmenu:function(t){return t.preventDefault(),e.openContext(t)}}},[e._v(" "+e._s(e.current.entry)+" ")]),n("div",[e._v(" "+e._s(e.current.pinyin)+" ")]),n("div",[e._v(" "+e._s(e.current.english)+" ")]),e.sentences.length?n("ul",e._l(e.sentences,(function(t,r){return n("li",{key:r},[n("span",{staticClass:"has-context",attrs:{title:t.pinyin},on:{contextmenu:function(n){return n.preventDefault(),function(n){return e.openContext(n,t.chinese,"sentence")}(n)}}},[e._v(" "+e._s(t.chinese)+" ")]),n("ul",[n("li",{staticClass:"english"},[e._v(" "+e._s(t.english)+" ")])])])})),0):e._e()]):"vocab"===e.current.type?n("div",[n("div",{staticClass:"font-zh-simp text-w-normal has-context",staticStyle:{"font-size":"2rem"},on:{contextmenu:function(t){return t.preventDefault(),e.openContext(t)}}},[e._v(" "+e._s(e.current.entry)+" ")]),e.current.traditional&&e.current.traditional.length?n("div",{staticClass:"font-zh-trad text-w-normal",staticStyle:{"font-size":"1.7rem"}},e._l(e.current.traditional,(function(t,r){return n("span",{key:r,staticClass:"traditional has-context",on:{contextmenu:function(n){return n.preventDefault(),function(n){return e.openContext(n,t)}(n)}}},[e._v(" "+e._s(t)+" ")])})),0):e._e(),n("div",[e._v(" "+e._s((e.current.pinyin||[]).join(" | "))+" ")]),n("ul",e._l(e.current.english,(function(t,r){return n("li",{key:r},[e._v(" "+e._s(t)+" ")])})),0),e.sentences.length?n("ul",e._l(e.sentences,(function(t,r){return n("li",{key:r},[n("span",{staticClass:"has-context",attrs:{title:t.pinyin},on:{contextmenu:function(n){return n.preventDefault(),function(n){return e.openContext(n,t.chinese,"sentence")}(n)}}},[e._v(" "+e._s(t.chinese)+" ")]),n("ul",[n("li",{staticClass:"english"},[e._v(" "+e._s(t.english)+" ")])])])})),0):e._e()]):n("div",[n("h2",{staticClass:"font-zh-simp text-w-normal has-context",on:{contextmenu:function(t){return t.preventDefault(),e.openContext(t)}}},[e._v(" "+e._s(e.current.entry)+" ")]),n("ul",[n("li",[e._v(" "+e._s(e.current.pinyin)+" ")])]),n("ul",[n("li",[e._v(" "+e._s(e.current.english)+" ")])])])])]):e._e(),n("div",{staticClass:"buttons-area"},[e.quizIndex>=e.quizArray.length?n("div",{staticClass:"buttons"},[n("button",{ref:"btnEndQuiz",staticClass:"button is-warning",on:{click:e.endQuiz,keypress:e.endQuiz}},[e._v(" End quiz ")])]):e.isQuizShownAnswer?n("div",{staticClass:"buttons-panel"},[n("div",{staticClass:"buttons"},[n("button",{ref:"btnMarkRight",staticClass:"button is-success",on:{click:function(t){return e.doMark("right")},keypress:function(t){return e.doMark("right")}}},[e._v(" Right ")]),n("button",{ref:"btnMarkWrong",staticClass:"button is-danger",on:{click:function(t){return e.doMark("wrong")},keypress:function(t){return e.doMark("wrong")}}},[e._v(" Wrong ")]),n("button",{ref:"btnMarkRepeat",staticClass:"button is-warning",on:{click:function(t){return e.doMark("repeat")},keypress:function(t){return e.doMark("repeat")}}},[e._v(" Repeat ")])]),n("div",{staticClass:"buttons"},[n("button",{ref:"btnHideAnswer",staticClass:"button is-warning",on:{click:function(t){e.isQuizShownAnswer=!1},keypress:function(t){e.isQuizShownAnswer=!1}}},[e._v(" Hide answer ")])])]):n("div",{staticClass:"buttons"},[n("button",{ref:"btnShowAnswer",staticClass:"button is-warning",on:{click:function(t){e.isQuizShownAnswer=!0},keypress:function(t){e.isQuizShownAnswer=!0}}},[e._v(" Show answer ")])])])]),n("ContextMenu",{ref:"context",attrs:{entry:e.ctxEntry,type:e.ctxType,source:e.ctxSource}})],1)},f=[],b=(n("cb29"),n("c975"),n("4d63"),n("ac1f"),n("25f0"),n("5319"),n("1276"),n("5530")),y=n("5962"),g=n.n(y),m=n("6825"),x=n("02ef"),w=n("d8bb"),_=function(e){Object(l["a"])(n,e);var t=Object(d["a"])(n);function n(){var e;return Object(u["a"])(this,n),e=t.apply(this,arguments),e.ctxEntry="",e.ctxType="",e.ctxSource="",e.isQuizShownAnswer=!1,e.isQuizModal=!1,e.quizIndex=-1,e.quizData={},e.dictionaryData={hanzi:{},vocab:{},extra:{}},e.current={},e.sentenceKey=0,e}return Object(o["a"])(n,[{key:"startQuiz",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.quizIndex=-1,e.next=3,this.initNextQuizItem();case 3:this.isQuizModal=!0;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"endQuiz",value:function(){this.isQuizModal=!1,this.$emit("quiz:ended")}},{key:"doMark",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=this.quizArray[this.quizIndex],!n){e.next=4;break}return e.next=4,x["a"].patch("/api/quiz/mark",void 0,{params:{id:n,type:t}});case 4:this.initNextQuizItem();case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"initNextQuizItem",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.isQuizShownAnswer=!1,Array(2).fill(null).map((function(e,n){var r=t.checkFront(n+1);r||t.cacheQuizItem({relativePosition:n+1})})),!this.quizArray[this.quizIndex+1]){e.next=5;break}return e.next=5,this.cacheQuizItem({relativePosition:0});case 5:this.current=function(){var e;while(1){if(e=t.quizData[t.quizArray[++t.quizIndex]],e&&e.entry&&(e.source||e.type))break;if(t.quizIndex>=t.quizArray.length)return{}}return"sentence"===e.type?Object(b["a"])(Object(b["a"])({},e),w["c"].findOne({chinese:e.entry})||{}):Object(b["a"])(Object(b["a"])({},e),t.dictionaryData[e.source||e.type][e.entry])}();case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"checkFront",value:function(e){e++;var t=this.quizData[this.quizArray[this.quizIndex+e]];if(!t)return!1;var n=t.entry,r=t.type,i=t.direction;return!!(n&&r&&i)&&("sentence"===r?!!w["c"].findOne({chinese:n}):!!this.dictionaryData[r][n])}},{key:"openContext",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.ctxEntry=n||this.current.entry||"",this.ctxType=r||this.current.type||"",this.ctxSource=n?"":this.current.source,this.context.open(t);case 4:case"end":return e.stop()}}),e,this)})));function t(t,n,r){return e.apply(this,arguments)}return t}()},{key:"doMask",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.map((function(t){e=e.replace(new RegExp("(^| |[^a-z])(".concat(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\d/g,"\\d?").replace(/\s+/g,"\\s*"),")($| |[^a-z])"),"gi"),'$1<span class="gray-box">$2</span>$3')})),e}},{key:"cacheQuizItem",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,r,i,a,u,o,l,d,h,p,v=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.relativePosition,r=void 0===n?0:n,r++,i=t.quizId,i=i||this.quizArray[this.quizIndex+r],i){e.next=6;break}return e.abrupt("return");case 6:if(a=this.quizData[i],a&&a.entry&&a.type&&a.direction){e.next=14;break}return e.next=10,x["a"].get("/api/quiz/many",{params:{ids:[i],select:["entry","type","source","direction","front","back","mnemonic"]}});case 10:u=e.sent,o=Object(s["a"])(u.data.result,1),l=o[0],l&&(a?Object.assign(a,l):a=l,a.id=i,a.type=a.type,a.entry=a.entry,a.source=a.source,this.$set(this.quizData,i,a));case 14:if(d=a.source||a.type,h=a.entry,h&&d){e.next=18;break}return e.abrupt("return");case 18:if("sentence"!==d){e.next=22;break}return e.next=21,x["a"].get("/api/sentence",{params:{entry:h,select:"chinese,english"}}).then((function(e){var t=e.data,n=w["c"].findOne({chinese:t.chinese});n||w["c"].insert({chinese:t.chinese,pinyin:g()(t.chinese,{keepRest:!0}),english:t.english.split("")[0]})}));case 21:return e.abrupt("return");case 22:if(this.dictionaryData[d][h]){e.next=27;break}return p={hanzi:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,x["a"].get("/api/hanzi",{params:{entry:h,select:"pinyin,english"}});case 2:return t=e.sent,n=t.data,r=n.pinyin,i=n.english,v.dictionaryData.hanzi[h]={pinyin:r,english:i},e.next=9,Object(w["a"])(h,5);case 9:if(!e.sent){e.next=11;break}v.sentenceKey=Math.random();case 11:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),vocab:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.t0=v.dictionaryData.vocab[h],e.t0){e.next=5;break}return e.next=4,x["a"].get("/api/vocab",{params:{entry:h,select:"traditional,pinyin,english"}}).then((function(e){var t=e.data.result;return{traditional:t.map((function(e){var t=e.traditional;return t||""})).filter((function(e){return e})).filter((function(e,t,n){return n.indexOf(e)===t})),pinyin:t.map((function(e){var t=e.pinyin;return t})).filter((function(e,t,n){return n.indexOf(e)===t})),english:t.map((function(e){var t=e.english;return t}))}}));case 4:e.t0=e.sent;case 5:return t=e.t0,n=t.traditional,r=t.pinyin,i=t.english,v.dictionaryData.vocab[h]={traditional:n,pinyin:r,english:i},e.next=12,Object(w["a"])(h,5);case 12:if(!e.sent){e.next=14;break}v.sentenceKey=Math.random();case 14:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),sentence:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),extra:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,x["a"].get("/api/extra",{params:{entry:h,select:"pinyin,english"}});case 2:return t=e.sent,n=t.data,r=n.pinyin,i=n.english,v.dictionaryData.extra[h]={pinyin:r,english:i},e.next=9,Object(w["a"])(h,5);case 9:if(!e.sent){e.next=11;break}v.sentenceKey=Math.random();case 11:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},e.next=26,p[d]();case 26:this.$set(this,"dictionaryData",this.dictionaryData);case 27:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"sentences",get:function(){return Object(w["b"])(this.current.entry,5)}}]),n}(p["d"]);Object(h["a"])([Object(p["b"])({required:!0})],_.prototype,"quizArray",void 0),Object(h["a"])([Object(p["c"])()],_.prototype,"context",void 0),_=Object(h["a"])([Object(p["a"])({components:{ContextMenu:m["a"]}})],_);var C=_,k=C,z=(n("bf2c"),n("2877")),q=Object(z["a"])(k,v,f,!1,null,"38de225c",null),O=q.exports,j=function(e){Object(l["a"])(n,e);var t=Object(d["a"])(n);function n(){var e;return Object(u["a"])(this,n),e=t.apply(this,arguments),e.isLoading=!1,e.isInit=!1,e.isQuizDashboardReady=!1,e.leechCard={q:"",isOpen:!1,page:1,total:0,perPage:5,sort:{field:"",order:"desc"},data:[],current:{id:"",entry:"",type:"",direction:"",source:""}},e.q="",e.type=["hanzi","vocab","sentence"],e.stage=["new","leech","learning"],e.direction=["se"],e.includeExtra=!0,e.includeUndue=!1,e.dueIn=null,e.quizArray=[],e.quizData={},e.cache={now:+new Date},e}return Object(o["a"])(n,[{key:"init",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,n,r,i,a,s,c,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,x["a"].get("/api/user",{params:{select:["settings.quiz"]}}).then((function(e){return e.data}));case 2:return t=e.sent,n=t["settings.quiz"]||{},r=n.type,i=n.stage,a=n.direction,s=n.includeExtra,c=n.includeUndue,u=n.q,r&&(this.type=r),i&&(this.stage=i),a&&(this.direction=a),"undefined"!==typeof s&&(this.includeExtra=s),"undefined"!==typeof c&&(this.includeUndue=c),this.q=u||"",this.isInit=!0,this.isLoading=!1,this.onLeechCardSubmit(),e.next=15,this.reload();case 15:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"reload",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,n,r,i,a,c,u,o=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,x["a"].get("/api/quiz/init",{params:{type:this.type,stage:this.stage,direction:this.direction,includeUndue:this.includeUndue,includeExtra:this.includeExtra,q:this.q}}).then((function(e){return e.data}));case 2:t=e.sent,n=t.quiz,r=t.upcoming,r=void 0===r?[]:r,i=Object(s["a"])(r,1),a=i[0],a=void 0===a?{}:a,c=a.nextReview,u=[],n.map((function(e){u.push(e.id),o.quizData[e.id]=e})),this.quizArray=u,this.$set(this,"quizData",this.quizData),this.dueIn=c?new Date(c):null;case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"startQuiz",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.quizCard.startQuiz();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onLeechCardSubmit",value:function(){this.leechCard.page=1,this.leechCard.sort={field:"",order:"asc"},this.loadLeechCard()}},{key:"loadLeechCard",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,x["a"].get("/api/quiz/leech",{params:{q:this.leechCard.q,page:this.leechCard.page,perPage:this.leechCard.perPage,sort:this.leechCard.sort.field,order:this.leechCard.sort.order}}).then((function(e){return e.data}));case 2:t=e.sent,n=t.result,r=t.count,this.leechCard.data=n,this.leechCard.total=r;case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onLeechSort",value:function(e,t){this.leechCard.sort={field:e,order:t},this.loadLeechCard()}},{key:"onLeechContextmenu",value:function(e,t){t.preventDefault(),this.leechCard.current=e,this.context.open(t)}},{key:"backlogItems",get:function(){var e=this;return this.cache.now=+new Date,this.quizArray.filter((function(t){var n=e.quizData[t];return n&&n.nextReview&&+new Date(n.nextReview)<e.cache.now}))}},{key:"dueItems",get:function(){return[].concat(Object(a["a"])(this.backlogItems),Object(a["a"])(this.newItems))}},{key:"newItems",get:function(){var e=this;return this.quizArray.filter((function(t){var n=e.quizData[t];return n&&"string"!==typeof n.nextReview}))}},{key:"leechItems",get:function(){var e=this;return this.quizArray.filter((function(t){var n=e.quizData[t];return n&&n.wrongStreak&&n.wrongStreak>2}))}}]),n}(p["d"]);Object(h["a"])([Object(p["c"])()],j.prototype,"quizCard",void 0),Object(h["a"])([Object(p["c"])()],j.prototype,"context",void 0),Object(h["a"])([Object(p["e"])("type",{deep:!0}),Object(p["e"])("stage",{deep:!0}),Object(p["e"])("direction",{deep:!0}),Object(p["e"])("includeUndue"),Object(p["e"])("includeExtra")],j.prototype,"reload",null),Object(h["a"])([Object(p["e"])("leechCard.page")],j.prototype,"loadLeechCard",null),j=Object(h["a"])([Object(p["a"])({components:{QuizCard:O,ContextMenu:m["a"]},created:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,r,i,a,s,c,u,o,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=window,r=n.frameElement,r&&(i=parseInt(r.getAttribute("data-id")||""),window.parent.setName(i,"Quiz")),t.next=4,x["a"].get("/api/user",{params:{select:["settings.quiz"]}}).then((function(e){return e.data}));case 4:return a=t.sent,s=a["settings.quiz"]||{},c=s.type,u=s.stage,o=s.direction,l=s.includeUndue,d=s.includeExtra,c&&(e.type=c),u&&(e.stage=u),o&&(e.direction=o),"boolean"===typeof l&&(e.includeUndue=l),"boolean"===typeof d&&(e.includeExtra=d),t.next=13,e.init();case 13:e.isQuizDashboardReady=!0;case 14:case"end":return t.stop()}}),t)})))()}})],j);var S=j,D=S,R=(n("b61c"),Object(z["a"])(D,r,i,!1,null,"75bc7eeb",null));t["default"]=R.exports},"62a4":function(e,t,n){},"81d5":function(e,t,n){"use strict";var r=n("7b0b"),i=n("23cb"),a=n("50c4");e.exports=function(e){var t=r(this),n=a(t.length),s=arguments.length,c=i(s>1?arguments[1]:void 0,n),u=s>2?arguments[2]:void 0,o=void 0===u?n:i(u,n);while(o>c)t[c++]=e;return t}},b61c:function(e,t,n){"use strict";n("62a4")},bf2c:function(e,t,n){"use strict";n("2218")},cb29:function(e,t,n){var r=n("23e7"),i=n("81d5"),a=n("44d2");r({target:"Array",proto:!0},{fill:i}),a("fill")}}]);
//# sourceMappingURL=quiz.82ff94f8.js.map