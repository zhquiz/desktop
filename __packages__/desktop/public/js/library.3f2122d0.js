(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["library"],{"55a5":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",[n("div",{staticClass:"LibraryPage"},[n("form",{staticClass:"field is-grouped",on:{submit:function(t){t.preventDefault(),e.q=e.q0}}},[n("b-field",{staticClass:"is-expanded",attrs:{label:"Search","label-position":"on-border"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.q0,expression:"q0"}],staticClass:"input",attrs:{type:"search",name:"q",placeholder:"Type here to search","aria-label":"search"},domProps:{value:e.q0},on:{input:function(t){t.target.composing||(e.q0=t.target.value)}}})])],1),n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("section",{staticClass:"card"},[n("div",{staticClass:"card-content"},[n("h2",{staticClass:"title is-4"},[e._v(" User library "),n("button",{staticClass:"button is-success",staticStyle:{float:"right"},on:{click:function(t){return e.openEditModal()}}},[e._v(" Create a list ")])]),e._l(e.local.result,(function(t,a){return n("LibraryCard",{key:a,attrs:{id:t.id,title:t.title,entries:t.entries,description:t.description,additional:e.additionalContext(t)}})})),e.local.count>e.local.perPage?n("b-pagination",{attrs:{total:e.local.count,"per-page":e.local.perPage,"icon-prev":"angle-left","icon-next":"angle-right"},on:{change:function(t){return e.local.page=t}},model:{value:e.local.page,callback:function(t){e.$set(e.local,"page",t)},expression:"local.page"}}):e._e()],2)])]),n("div",{staticClass:"column"},[n("section",{staticClass:"card"},[n("div",{staticClass:"card-content"},[n("h2",{staticClass:"title is-4"},[e._v("Online library")]),e._l(e.online.result,(function(e,t){return n("LibraryCard",{key:t,attrs:{title:e.title,entries:e.entries,description:e.description}})})),e.online.count>e.online.perPage?n("b-pagination",{attrs:{total:e.online.count,"per-page":e.online.perPage,"icon-prev":"angle-left","icon-next":"angle-right"},on:{change:function(t){return e.online.page=t}},model:{value:e.online.page,callback:function(t){e.$set(e.online,"page",t)},expression:"online.page"}}):e._e()],2)])])])]),n("b-modal",{model:{value:e.isEditModal,callback:function(t){e.isEditModal=t},expression:"isEditModal"}},[n("div",{staticClass:"card"},[n("header",{staticClass:"card-header"},[e.edited.id?n("div",{staticClass:"card-header-title"},[e._v("Edit list")]):n("div",{staticClass:"card-header-title"},[e._v("New list")])]),n("div",{staticClass:"card-content"},[n("b-field",{attrs:{label:"Title"}},[n("b-input",{attrs:{placeholder:"Must not be empty"},model:{value:e.edited.title,callback:function(t){e.$set(e.edited,"title",t)},expression:"edited.title"}})],1),n("b-field",{attrs:{label:"Entries"}},[n("b-input",{attrs:{type:"textarea",placeholder:"Space separated, must not be empty"},model:{value:e.entryString,callback:function(t){e.entryString=t},expression:"entryString"}})],1),n("b-field",{attrs:{label:"Description"}},[n("b-input",{attrs:{type:"textarea"},model:{value:e.edited.description,callback:function(t){e.$set(e.edited,"description",t)},expression:"edited.description"}})],1),n("b-field",{attrs:{label:"Tag"}},[n("b-input",{model:{value:e.edited.tag,callback:function(t){e.$set(e.edited,"tag",t)},expression:"edited.tag"}})],1)],1),n("footer",{staticClass:"card-footer"},[n("div",{staticClass:"card-footer-item"},[n("button",{staticClass:"button is-success",attrs:{type:"button"},on:{click:function(t){e.edited.id?e.doUpdate():e.doCreate()}}},[e._v(" Save ")]),n("button",{staticClass:"button is-cancel",attrs:{type:"button"},on:{click:function(t){e.isEditModal=!1}}},[e._v(" Cancel ")])])])])])],1)},i=[],r=(n("99af"),n("a15b"),n("d3b7"),n("ac1f"),n("3ca3"),n("ddb0"),n("5530")),s=(n("96cf"),n("1da1")),c=n("d4ec"),o=n("bee2"),u=n("262e"),l=n("2caf"),d=n("9ab4"),p=n("02ef"),f=n("1b40"),b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",[n("b-collapse",{staticClass:"card",attrs:{animation:"slide"},scopedSlots:e._u([{key:"trigger",fn:function(t){return n("div",{staticClass:"card-header",attrs:{role:"button"}},[n("p",{staticClass:"card-header-title",on:{contextmenu:function(t){return t.preventDefault(),function(t){e.selected=e.currentData,e.$refs.context.open(t)}(t)}}},[e._v(" "+e._s(e.title)+" ")]),n("a",{staticClass:"card-header-icon"},[n("b-icon",{attrs:{icon:t.open?"caret-down":"caret-up"}})],1)])}}]),model:{value:e.isOpen,callback:function(t){e.isOpen=t},expression:"isOpen"}},[n("div",{staticClass:"card-content"},[n("div",e._l(e.currentData,(function(t){return n("span",{key:t,staticClass:"tag clickable",class:e.getTagClass(t),on:{contextmenu:function(n){return n.preventDefault(),function(n){e.selected=[t],e.$refs.context.open(n)}(n)}}},[e._v(" "+e._s(t)+" ")])})),0)])]),n("ContextMenu",{ref:"context",attrs:{type:"vocab",entry:e.selected,description:e.title+" "+e.description,additional:e.additional},on:{"quiz:added":function(t){return e.reload(t.entries)},"quiz:removed":function(t){return e.reload(t.entries)}}})],1)},h=[],v=(n("4de4"),n("c975"),n("d81d"),n("b85c")),g=n("6825"),y=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.apply(this,arguments),e.isOpen=!1,e.selected=[],e.srsLevel={},e.tagClassMap=[function(e){return e>2?"is-success":""},function(e){return e>0?"is-warning":""},function(e){return 0===e?"is-danger":""}],e}return Object(o["a"])(n,[{key:"reload",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n,a,i,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=10;break}return e.next=3,p["a"].post("/api/quiz/srsLevel",{entries:t,type:"vocab",select:["entry","srsLevel"]});case 3:n=e.sent,a=n.data.result,i=void 0===a?[]:a,t.map((function(e){delete r.srsLevel[e]})),i.map((function(e){var t=e.entry,n=e.srsLevel;r.srsLevel[t]="number"===typeof n?n:-1})),this.$set(this,"srsLevel",this.srsLevel),this.$forceUpdate();case 10:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getTagClass",value:function(e){var t=this.srsLevel[e];if("undefined"!==typeof t){if(-1===t)return"is-info";var n,a=Object(v["a"])(this.tagClassMap);try{for(a.s();!(n=a.n()).done;){var i=n.value,r=i(t);if(r)return r}}catch(s){a.e(s)}finally{a.f()}}return"is-light"}},{key:"currentData",get:function(){return this.entries.filter((function(e,t,n){return n.indexOf(e)===t}))}}]),n}(f["d"]);Object(d["a"])([Object(f["b"])()],y.prototype,"title",void 0),Object(d["a"])([Object(f["b"])()],y.prototype,"entries",void 0),Object(d["a"])([Object(f["b"])({default:""})],y.prototype,"description",void 0),Object(d["a"])([Object(f["b"])({default:function(){return[]}})],y.prototype,"additional",void 0),Object(d["a"])([Object(f["c"])()],y.prototype,"context",void 0),y=Object(d["a"])([Object(f["a"])({components:{ContextMenu:g["a"]},watch:{isOpen:function(){this.isOpen&&this.reload(this.currentData)},entries:function(){this.isOpen=!1}}})],y);var m=y,D=m,C=(n("68cb"),n("2877")),O=Object(C["a"])(D,b,h,!1,null,"58f6a876",null),x=O.exports,j=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.apply(this,arguments),e.q0="",e.isEditModal=!1,e.local={result:[],count:0,page:1,perPage:10},e.online={result:[],count:0,page:1,perPage:10},e.edited={id:"",title:"",entries:[],description:"",tag:""},e}return Object(o["a"])(n,[{key:"additionalContext",value:function(e){var t=this;return e.id?[{name:"Edit list",handler:function(){t.openEditModal()}},{name:"Delete list",handler:function(){t.doDelete(e.id)}}]:[]}},{key:"openEditModal",value:function(e){this.edited=e||{id:"",title:"",entries:[],description:"",tag:""},this.isEditModal=!0}},{key:"updateLocal",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p["a"].get("/api/library/q",{params:{q:this.q,page:this.local.page,perPage:this.local.perPage}}).then((function(e){return e.data}));case 2:t=e.sent,this.local=Object(r["a"])(Object(r["a"])({},this.local),t);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"updateOnline",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://www.zhquiz.cc/api/library?q=".concat(encodeURIComponent(this.q),"&page=").concat(encodeURIComponent(this.online.page),"&perPage=").concat(encodeURIComponent(this.online.perPage))).then((function(e){return e.json()}));case 2:t=e.sent,this.online=Object(r["a"])(Object(r["a"])({},this.online),t);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"doCreate",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p["a"].put("/api/library",this.edited);case 2:return this.$buefy.snackbar.open("Created list: ".concat(this.edited.title)),this.isEditModal=!1,this.local.page=1,e.next=7,this.updateLocal();case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"doUpdate",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p["a"].patch("/api/library",this.edited,{params:{id:this.edited.id}});case 2:return this.$buefy.snackbar.open("Updated list: ".concat(this.edited.title)),this.isEditModal=!1,this.local.page=1,e.next=7,this.updateLocal();case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"doDelete",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p["a"].delete("/api/library",{params:{id:t}});case 2:return this.$buefy.snackbar.open("Deleted list: ".concat(this.edited.title)),this.local.page=1,e.next=6,this.updateLocal();case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"q",get:function(){var e=this.$route.query.q;return(Array.isArray(e)?e[0]:e)||""},set:function(e){this.$router.push({query:{q:e}})}},{key:"entryString",get:function(){return this.edited.entries.join(" ")},set:function(e){var t=[],n=null,a=/(?:[\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u3005\u3007\u3021-\u3029\u3038-\u303B\u3400-\u4DBF\u4E00-\u9FFC\uF900-\uFA6D\uFA70-\uFAD9]|\uD81B[\uDFF0\uDFF1]|[\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])+/g;while(n=a.exec(e))t.push(n[0]);this.edited.entries=t}}]),n}(f["d"]);Object(d["a"])([Object(f["e"])("q"),Object(f["e"])("local.page")],j.prototype,"updateLocal",null),Object(d["a"])([Object(f["e"])("q"),Object(f["e"])("online.page")],j.prototype,"updateOnline",null),j=Object(d["a"])([Object(f["a"])({components:{LibraryCard:x},created:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=window,a=n.frameElement,a&&(i=parseInt(a.getAttribute("data-id")||""),window.parent.setName(i,"Library")),t.next=4,Promise.all([e.updateLocal(),e.updateOnline()]);case 4:case"end":return t.stop()}}),t)})))()}})],j);var w=j,k=w,F=(n("eb1b"),Object(C["a"])(k,a,i,!1,null,"11e6d410",null));t["default"]=F.exports},"68cb":function(e,t,n){"use strict";n("7b25")},"7b25":function(e,t,n){},b85c:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("a4d3"),n("e01a"),n("d28b"),n("d3b7"),n("3ca3"),n("ddb0");var a=n("06c5");function i(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Object(a["a"])(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,c=!0,o=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return c=e.done,e},e:function(e){o=!0,s=e},f:function(){try{c||null==n["return"]||n["return"]()}finally{if(o)throw s}}}}},c813:function(e,t,n){},eb1b:function(e,t,n){"use strict";n("c813")}}]);
//# sourceMappingURL=library.3f2122d0.js.map